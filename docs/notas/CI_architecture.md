# ğŸ¨ Arquitectura CI/CD - TFG Chatbot

## ğŸ“Š Diagrama de Flujo de Workflows

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PUSH / PULL REQUEST                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Workflows AutomÃ¡ticos (RÃ¡pidos)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Code Quality â”‚    â”‚  Unit Tests  â”‚    â”‚Build Contain.â”‚
â”‚  (lint.yml)  â”‚    â”‚(unit-*.yml)  â”‚    â”‚  (build-.yml)â”‚
â”‚              â”‚    â”‚              â”‚    â”‚              â”‚
â”‚ â€¢ ruff       â”‚    â”‚ â€¢ backend/   â”‚    â”‚ â€¢ Dockerfile â”‚
â”‚ â€¢ black      â”‚    â”‚   tests/     â”‚    â”‚   validation â”‚
â”‚ â€¢ isort      â”‚    â”‚ â€¢ rag_serviceâ”‚    â”‚ â€¢ Smoke test â”‚
â”‚ â€¢ mypy       â”‚    â”‚   tests/     â”‚    â”‚ â€¢ Cache      â”‚
â”‚              â”‚    â”‚ â€¢ Coverage   â”‚    â”‚              â”‚
â”‚ ~1-2 min     â”‚    â”‚ ~3-5 min     â”‚    â”‚ ~5-7 min     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â”‚ âœ… PASS           â”‚ âœ… PASS           â”‚ âœ… PASS
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  PR Check      â”‚
                  â”‚  (ci.yml)      â”‚
                  â”‚                â”‚
                  â”‚ â€¢ Info del PR  â”‚
                  â”‚ â€¢ Resumen      â”‚
                  â”‚ â€¢ Comandos     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    âœ… PR READY TO MERGE
                           â”‚
                           â–¼
                    [ MERGE TO MAIN ]
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
        â–¼                  â–¼                  â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Jekyll  â”‚      â”‚ Tag Created â”‚    â”‚  Security  â”‚
  â”‚ Pages   â”‚      â”‚    (v*)     â”‚    â”‚   Scan     â”‚
  â”‚(jekyll  â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚ (weekly/   â”‚
  â”‚  .yml)  â”‚             â”‚           â”‚  deps)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â–¼           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Release    â”‚
                   â”‚(release.yml)â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Workflows Manual / Nocturno (Lentos)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Infrastructure Tests     â”‚      â”‚    Integration Tests         â”‚
  â”‚  (infrastructure-*.yml)   â”‚      â”‚   (integration-tests.yml)    â”‚
  â”‚                           â”‚      â”‚                              â”‚
  â”‚  ğŸŒ™ Nightly 2 AM UTC      â”‚      â”‚  ğŸŒ™ Nightly 3 AM UTC         â”‚
  â”‚  ğŸ–±ï¸  Manual dispatch      â”‚      â”‚  ğŸ–±ï¸  Manual dispatch         â”‚
  â”‚                           â”‚      â”‚  ğŸ“ PRs con cambios crÃ­ticos â”‚
  â”‚  1. docker-compose up     â”‚      â”‚                              â”‚
  â”‚  2. Esperar servicios     â”‚      â”‚  1. docker-compose up        â”‚
  â”‚  3. Init Ollama           â”‚      â”‚  2. Esperar servicios        â”‚
  â”‚  4. pytest infra/ -m      â”‚      â”‚  3. Init Ollama              â”‚
  â”‚     podman_container      â”‚      â”‚  4. pytest integration/      â”‚
  â”‚                           â”‚      â”‚     -m integration           â”‚
  â”‚  Tests:                   â”‚      â”‚                              â”‚
  â”‚  â€¢ MongoDB (10)           â”‚      â”‚  Tests:                      â”‚
  â”‚  â€¢ Qdrant (8)             â”‚      â”‚  â€¢ Chat E2E                  â”‚
  â”‚  â€¢ Ollama (12)            â”‚      â”‚  â€¢ RAG workflow              â”‚
  â”‚  â€¢ Backend (4)            â”‚      â”‚  â€¢ Memoria                   â”‚
  â”‚  â€¢ RAG Service (10)       â”‚      â”‚  â€¢ Filtros metadata          â”‚
  â”‚  â€¢ vLLM (6)               â”‚      â”‚  â€¢ Upload archivos           â”‚
  â”‚                           â”‚      â”‚                              â”‚
  â”‚  ~15-20 min               â”‚      â”‚  ~20-30 min                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security & Dependencies                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Security Scan          â”‚       â”‚      Dependabot              â”‚
  â”‚   (security.yml)         â”‚       â”‚   (dependabot.yml)           â”‚
  â”‚                          â”‚       â”‚                              â”‚
  â”‚  ğŸ“… Weekly (Lunes 8 AM)  â”‚       â”‚  ğŸ“… Weekly (Lunes)           â”‚
  â”‚  ğŸ“ PRs con deps changes â”‚       â”‚  ğŸ¤– Automated PRs            â”‚
  â”‚  ğŸ–±ï¸  Manual              â”‚       â”‚                              â”‚
  â”‚                          â”‚       â”‚  Ecosystems:                 â”‚
  â”‚  Tools:                  â”‚       â”‚  â€¢ github-actions            â”‚
  â”‚  â€¢ pip-audit             â”‚       â”‚  â€¢ pip (root)                â”‚
  â”‚  â€¢ safety check          â”‚       â”‚  â€¢ pip (backend)             â”‚
  â”‚  â€¢ Trivy (Docker)        â”‚       â”‚  â€¢ pip (rag_service)         â”‚
  â”‚  â€¢ Matrix Py 3.11/3.12   â”‚       â”‚  â€¢ docker                    â”‚
  â”‚                          â”‚       â”‚                              â”‚
  â”‚  âš ï¸  No falla build      â”‚       â”‚  Max 5 PRs/ecosystem         â”‚
  â”‚  ~5-8 min                â”‚       â”‚                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Flujo de DecisiÃ³n

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Nuevo Commit â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Â¿Es PR o Push?â”‚
                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                        â”‚        â”‚
                    PR  â”‚        â”‚  Push to main
                        â”‚        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Run en PR:   â”‚  â”‚ Run en main:  â”‚
            â”‚ â€¢ lint       â”‚  â”‚ â€¢ lint        â”‚
            â”‚ â€¢ unit tests â”‚  â”‚ â€¢ unit tests  â”‚
            â”‚ â€¢ builds     â”‚  â”‚ â€¢ builds      â”‚
            â”‚ â€¢ pr-info    â”‚  â”‚ â€¢ jekyll      â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Â¿Todos los checks âœ…?  â”‚
            â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
               â”‚                  â”‚
          âœ… SI               âŒ NO
               â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PR Mergeable   â”‚    â”‚ PR Blocked      â”‚
    â”‚ âœ“ Can merge    â”‚    â”‚ âœ— Fix required  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Cuando mergear a main:              â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  âœ… Todos los checks automÃ¡ticos OK  â”‚
    â”‚  âœ… Code review aprobado (opcional)  â”‚
    â”‚  âœ… Branch updated (opcional)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ Timeline de EjecuciÃ³n

### DÃ­a Normal (con PR):
```
00:00 â”€â”€â”€â”¬â”€ PR Created
         â”‚
         â”œâ”€ 00:01  [START] Code Quality
         â”œâ”€ 00:02  [START] Unit Tests Backend
         â”œâ”€ 00:02  [START] Unit Tests RAG
         â”œâ”€ 00:03  [START] Build Backend
         â”œâ”€ 00:03  [START] Build RAG Service
         â”‚
         â”œâ”€ 00:03  [DONE] Code Quality âœ…
         â”œâ”€ 00:05  [DONE] Unit Tests Backend âœ…
         â”œâ”€ 00:05  [DONE] Unit Tests RAG âœ…
         â”œâ”€ 00:08  [DONE] Build Backend âœ…
         â”œâ”€ 00:09  [DONE] Build RAG Service âœ…
         â”‚
         â””â”€ 00:09  [SUMMARY] All checks passed âœ…
         
         Total: ~9 minutos
```

### DÃ­a con Cambio de Dependencias:
```
00:00 â”€â”€â”€â”¬â”€ PR with pyproject.toml change
         â”‚
         â”œâ”€ 00:00  [START] Code Quality
         â”œâ”€ 00:00  [START] Unit Tests
         â”œâ”€ 00:00  [START] Builds
         â”œâ”€ 00:05  [START] Security Scan
         â”‚
         â”œâ”€ 00:09  [DONE] Fast checks âœ…
         â”œâ”€ 00:14  [DONE] Security Scan âš ï¸
         â”‚
         â””â”€ 00:14  Complete
         
         Total: ~14 minutos
```

### Noche AutomÃ¡tica:
```
02:00 â”€â”€â”€â”¬â”€ [START] Infrastructure Tests (nightly)
         â”‚  â€¢ docker-compose up
         â”‚  â€¢ Wait for services
         â”‚  â€¢ Init Ollama
         â”‚  â€¢ pytest infrastructure/
         â”‚
         â”œâ”€ 02:20  [DONE] Infrastructure Tests âœ…
         â”‚
03:00 â”€â”€â”€â”¼â”€ [START] Integration Tests (nightly)
         â”‚  â€¢ docker-compose up
         â”‚  â€¢ Wait for services  
         â”‚  â€¢ pytest integration/
         â”‚
         â”œâ”€ 03:30  [DONE] Integration Tests âœ…
         â”‚
         â””â”€ 03:30  Cleanup
         
         Total infraestructura: 50 minutos
```

### Lunes (Weekly):
```
08:00 â”€â”€â”€â”¬â”€ [START] Security Scan (weekly)
         â”‚  â€¢ pip-audit
         â”‚  â€¢ safety check
         â”‚  â€¢ Trivy Docker
         â”‚  â€¢ Matrix Python versions
         â”‚
         â”œâ”€ 08:08  [DONE] Security Scan âš ï¸
         â”‚
09:00 â”€â”€â”€â”¼â”€ [START] Dependabot PRs
         â”‚  â€¢ Check updates (github-actions)
         â”‚  â€¢ Check updates (pip packages)
         â”‚  â€¢ Check updates (Docker images)
         â”‚  â€¢ Create PRs (max 5 per ecosystem)
         â”‚
         â””â”€ 09:15  [DONE] Dependabot PRs created
         
         Weekly tasks: 1h 15min total
```

## ğŸ—ï¸ Arquitectura de Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             CAPA 1: Fast Feedback               â”‚
â”‚  Objetivo: < 10 min, bloquea PRs               â”‚
â”‚                                                 â”‚
â”‚  â€¢ Code Quality (lint, format)                 â”‚
â”‚  â€¢ Unit Tests (sin containers)                 â”‚
â”‚  â€¢ Build Validation (Dockerfiles)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CAPA 2: Security & Quality             â”‚
â”‚  Objetivo: Weekly, no bloquea                  â”‚
â”‚                                                 â”‚
â”‚  â€¢ Security Scanning (vulnerabilities)         â”‚
â”‚  â€¢ Dependency updates (Dependabot)             â”‚
â”‚  â€¢ Type checking (mypy)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CAPA 3: Integration & E2E                â”‚
â”‚  Objetivo: Nightly/Manual, comprehensive       â”‚
â”‚                                                 â”‚
â”‚  â€¢ Infrastructure Tests (containers)           â”‚
â”‚  â€¢ Integration Tests (full stack)              â”‚
â”‚  â€¢ Performance benchmarks (futuro)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Matriz de Tests

| Test Type | Location | When | Duration | Blocks PR |
|-----------|----------|------|----------|-----------|
| Linting | `lint.yml` | Every PR/Push | ~1-2 min | âœ… Yes |
| Unit (Backend) | `backend/tests/` | Every PR/Push | ~2-3 min | âœ… Yes |
| Unit (RAG) | `rag_service/tests/` | Every PR/Push | ~2-3 min | âœ… Yes |
| Build | `build-containers.yml` | Every PR/Push | ~5-7 min | âœ… Yes |
| Infrastructure | `tests/infrastructure/` | Nightly/Manual | ~15-20 min | âŒ No |
| Integration | `tests/integration/` | Nightly/Manual | ~20-30 min | âŒ No |
| Security | `security.yml` | Weekly/Changes | ~5-8 min | âŒ No |

## ğŸ”„ Estado de Cobertura

```
Backend Coverage:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 55%    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RAG Service Coverage:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 68%    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Integration Coverage:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 82%    â”‚  (nightly)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Target: 80% en todos los servicios
```

## ğŸ“Š MÃ©tricas Objetivo

| MÃ©trica | Actual | Objetivo | Estado |
|---------|--------|----------|--------|
| PR Check Time | ~9 min | < 10 min | âœ… |
| Build Success Rate | TBD | > 95% | ğŸ”„ |
| Test Flakiness | TBD | < 2% | ğŸ”„ |
| Security Issues | TBD | 0 Critical | ğŸ”„ |
| Coverage Backend | ~55% | > 80% | ğŸ”„ |
| Coverage RAG | ~68% | > 80% | ğŸ”„ |
| Dependabot PRs | TBD | 3-5/week | ğŸ”„ |

---

**Ãšltima actualizaciÃ³n**: 15 noviembre 2025  
**VersiÃ³n**: 1.0.0  
**Status**: âœ… Implementado y documentado
